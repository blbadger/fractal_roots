Optimized using numexpr for multithreading and efficient memory allocation.  Between 3x and 6x faster than the non-optimized versions, depending on CPU core and thread number and architecture.
